{{ 'custom-news.css' | asset_url | stylesheet_tag }}

<div class="custom-news design-scale" data-section-id="{{ section.id }}">
  <!-- Section Title -->
  <div class="news-header">
    <h2 class="section-title">{{ section.settings.heading }}</h2>
  </div>

  <!-- News Grid -->
  <div class="news-grid">
    {%- if section.settings.blog != blank and section.settings.blog.articles_count > 0 -%}
      {%- for article in section.settings.blog.articles limit: 4 -%}
        <div class="news-card">
          <!-- Card Image -->
          {%- if section.settings.show_image and article.image -%}
            <a href="{{ article.url }}" class="news-card-image-link">
              <div class="news-card-image">
                <img
                  src="{{ article.image | image_url: width: 690 }}"
                  srcset="{{ article.image | image_url: width: 345 }} 345w,
                          {{ article.image | image_url: width: 690 }} 690w"
                  sizes="(min-width: 990px) 345px, 345px"
                  alt="{{ article.image.alt | escape }}"
                  loading="lazy"
                  width="345"
                  height="380"
                >
              </div>
            </a>
          {%- endif -%}

          <!-- Card Content -->
          <div class="news-card-content">
            <!-- Title -->
            <h3 class="news-card-title">
              {{ article.title | escape }}
            </h3>

            <!-- Excerpt -->
            {%- if section.settings.show_excerpt -%}
              <p class="news-card-excerpt">
                {%- if article.excerpt.size > 0 -%}
                  {{ article.excerpt | strip_html }}
                {%- else -%}
                  {{ article.content | strip_html | truncatewords: 20 }}
                {%- endif -%}
              </p>
            {%- endif -%}

            <!-- Footer: Date & Read More -->
            <div class="news-card-footer">
              {%- if section.settings.show_date -%}
                <span class="news-card-date">
                  {{ article.published_at | date: "%b %d, %Y" }}
                </span>
              {%- endif -%}
              <a href="{{ article.url }}" class="news-card-link">Read more</a>
            </div>
          </div>
        </div>
      {%- endfor -%}
    {%- else -%}
      <!-- Placeholder cards when no blog is selected -->
      {%- for i in (1..4) -%}
        <div class="news-card news-card-placeholder">
          <div class="news-card-image">
            <div class="news-card-placeholder-image">
              {{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}
            </div>
          </div>
          <div class="news-card-content">
            <h3 class="news-card-title">
              Meraki Autumn Recipes: Craft Your Seasonal ...
            </h3>
            <p class="news-card-excerpt">
              Meraki Autumn Recipes: Craft Your Seasonal Meraki Autumn...
            </p>
            <div class="news-card-footer">
              <span class="news-card-date">Apr 11, 2025</span>
              <a href="#" class="news-card-link">Read more</a>
            </div>
          </div>
        </div>
      {%- endfor -%}
    {%- endif -%}
  </div>

  <!-- View All Button -->
  {%- if section.settings.show_view_all -%}
    <div class="news-view-all-container">
      {%- if section.settings.view_all_link != blank -%}
        <a href="{{ section.settings.view_all_link }}" class="news-view-all">View All</a>
      {%- elsif section.settings.blog != blank -%}
        <a href="{{ section.settings.blog.url }}" class="news-view-all">View All</a>
      {%- endif -%}
    </div>
  {%- endif -%}
</div>

{% schema %}
{
  "name": "Custom News",
  "settings": [
    {
      "type": "blog",
      "id": "blog",
      "label": "Blog"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Latest News"
    },
    {
      "type": "checkbox",
      "id": "show_image",
      "label": "Show featured image",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_date",
      "label": "Show date",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_excerpt",
      "label": "Show excerpt",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_view_all",
      "label": "Show view all button",
      "default": true
    },
    {
      "type": "url",
      "id": "view_all_link",
      "label": "View all link",
      "info": "Custom URL for the view all button. Leave blank to use blog URL."
    }
  ],
  "presets": [
    {
      "name": "Custom News"
    }
  ]
}
{% endschema %}


