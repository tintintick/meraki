{{ 'meraki-subscribe.css' | asset_url | stylesheet_tag }}

<div class="meraki-subscribe design-scale" data-section-id="{{ section.id }}">
  <div class="subscribe-container">
    <!-- Left Column: Title + Features -->
    <div class="subscribe-content">
      <!-- Section Title -->
      <div class="subscribe-header">
        <h2 class="section-title">{{ section.settings.heading }}</h2>
      </div>

      <!-- Features List -->
      <div class="subscribe-features">
        <!-- Feature 1: Join Meraki -->
        <div class="feature-item">
          <div class="feature-icon">
            <img src="{{ 'subscribe/Join Meraki.svg' | asset_url }}" alt="Join Meraki" loading="lazy" width="48" height="48">
          </div>
          <div class="feature-text">
            {{ section.settings.feature1_text }}
          </div>
        </div>

        <!-- Feature 2: VIP Support -->
        <div class="feature-item">
          <div class="feature-icon">
            <img src="{{ 'subscribe/VIP.svg' | asset_url }}" alt="VIP" loading="lazy" width="42" height="42">
          </div>
          <div class="feature-text">
            {{ section.settings.feature2_text }}
          </div>
        </div>

        <!-- Feature 3: Access Tutorials -->
        <div class="feature-item">
          <div class="feature-icon">
            <img src="{{ 'subscribe/Access.svg' | asset_url }}" alt="Access" loading="lazy" width="42" height="42">
          </div>
          <div class="feature-text">
            {{ section.settings.feature3_text }}
          </div>
        </div>
      </div>
    </div>

    <!-- Right Column: Subscribe Form -->
    <div class="subscribe-form-wrapper">
    {% form 'customer', class: 'subscribe-form' %}
      <input type="hidden" name="contact[tags]" value="{{ section.settings.customer_tag | escape }}">
      
      <!-- Email Input Container -->
      <div class="subscribe-input-wrapper">
        <div class="email-icon">
          <img src="{{ 'subscribe/email.svg' | asset_url }}" alt="Email" loading="lazy" width="32" height="32">
        </div>
        <input
          id="SubscribeEmail-{{ section.id }}"
          type="email"
          name="contact[email]"
          class="subscribe-input"
          value="{{ form.email }}"
          autocorrect="off"
          autocapitalize="off"
          autocomplete="email"
          placeholder="{{ section.settings.placeholder }}"
          required
          aria-required="true"
          {% if form.errors %}
            aria-invalid="true"
            aria-describedby="Subscribe-error-{{ section.id }}"
          {% elsif form.posted_successfully? %}
            aria-describedby="Subscribe-success-{{ section.id }}"
          {% endif %}
        >
      </div>

      <!-- Submit Button -->
      <button type="submit" class="subscribe-button">
        {{ section.settings.button_text }}
      </button>

      <!-- Error Message -->
      {%- if form.errors -%}
        <div class="subscribe-message subscribe-error" id="Subscribe-error-{{ section.id }}">
          <span class="error-icon">
            {{- 'icon-error.svg' | inline_asset_content -}}
          </span>
          <span class="error-text">{{ form.errors | default_errors }}</span>
        </div>
      {%- endif -%}

      <!-- Success Message -->
      {%- if form.posted_successfully? -%}
        <div class="subscribe-message subscribe-success" id="Subscribe-success-{{ section.id }}" tabindex="-1">
          <span class="success-icon">
            {{- 'icon-success.svg' | inline_asset_content -}}
          </span>
          <span class="success-text">{{ section.settings.success_message }}</span>
        </div>
      {%- endif -%}
    {% endform %}
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Meraki Subscribe",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Section Title",
      "default": "Stay Inspired with Meraki"
    },
    {
      "type": "richtext",
      "id": "feature1_text",
      "label": "Feature 1 Text",
      "default": "<p>Join Meraki and enjoy exclusive offers and promotions.</p>"
    },
    {
      "type": "richtext",
      "id": "feature2_text",
      "label": "Feature 2 Text",
      "default": "<p>Get VIP support from your dedicated concierge.</p>"
    },
    {
      "type": "richtext",
      "id": "feature3_text",
      "label": "Feature 3 Text",
      "default": "<p>Access personalized tutorials tailored to your coffee journey.</p>"
    },
    {
      "type": "text",
      "id": "placeholder",
      "label": "Email Input Placeholder",
      "default": "Enter your email address"
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button Text",
      "default": "Subscribe"
    },
    {
      "type": "text",
      "id": "customer_tag",
      "label": "Customer Tag",
      "default": "newsletter-subscribe",
      "info": "Tag added to customers when they subscribe"
    },
    {
      "type": "text",
      "id": "success_message",
      "label": "Success Message",
      "default": "Thank you for subscribing!"
    }
  ],
  "presets": [
    {
      "name": "Meraki Subscribe"
    }
  ]
}
{% endschema %}
