/* Custom Video (mobile-first) */

.custom-video {
  position: relative;
  width: 100%;
  overflow: hidden;
}

.custom-video.design-scale {
  /* mobile tokens based on 750px mock */
  --section-width: 750px;
  --section-height: 601px;
  --section-bg: #f0f0f0;

  /* Container */
  --container-margin: 40px;
  --container-gap: 40px;

  /* Header */
  --header-height: 104px;

  /* Title */
  --title-width: 455px;
  --title-font-size: 48px;
  --title-line-height: 52px;

  /* Switch */
  --switch-width: 170px;
  --switch-height: 60px;
  --button-size: 60px;
  --button-gap: 50px;

  /* Player */
  --player-width: 680px;
  --player-height: 382px;

  /* Play Button */
  --play-button-size: 75px;

  /* Video Info */
  --creator-avatar-size: 80px;
  --creator-name-width: 360px;
  --video-title-width: 360px;
  --video-info-padding: 24px;
  --video-info-gap: 14px;
  --creator-name-font-size: 20px;
  --creator-name-line-height: 20px;
  --video-title-font-size: 18px;
  --video-title-line-height: 20px;

  /* Border radius */
  --border-radius: 10px;

  width: 100%;
  height: calc(var(--section-height) * var(--scale-factor-mobile, 1));
  background-color: var(--section-bg);
}

/* Container */
.video-container {
  width: calc(100% - calc(var(--container-margin) * 2));
  margin-left: var(--container-margin);
  margin-right: var(--container-margin);
  padding: 0;
  background: transparent;
  display: flex;
  flex-direction: column;
  gap: calc(var(--container-gap) * var(--scale-factor-mobile, 1));
  align-items: center;
  justify-content: center;
  height: 100%;
}

/* Header */
.video-header {
  width: calc(var(--player-width) * var(--scale-factor-mobile, 1));
  height: calc(var(--header-height) * var(--scale-factor-mobile, 1));
  display: flex;
  justify-content: space-between;
  align-items: flex-end;
}

/* Title Wrapper */
/* .video-title-wrapper {
  width: calc(var(--title-width) * var(--scale-factor-mobile, 1));
  height: calc(var(--header-height) * var(--scale-factor-mobile, 1));
  overflow-x: scroll;
  overflow-y: hidden;
  position: relative;
  scroll-snap-type: x mandatory;
  scroll-behavior: smooth;
  scrollbar-width: none;
  -ms-overflow-style: none;
} */

.video-title-wrapper::-webkit-scrollbar {
  display: none;
}

/* Titles Track */
.video-titles-track {
  display: flex;
  height: 100%;
}

/* Section Title */
.video-section-title {
  width: calc(var(--title-width) * var(--scale-factor-mobile, 1));
  height: calc(var(--header-height) * var(--scale-factor-mobile, 1));
  font-family: 'Kanit', sans-serif;
  font-weight: 600;
  font-size: calc(var(--title-font-size) * var(--scale-factor-mobile, 1));
  line-height: calc(var(--title-line-height) * var(--scale-factor-mobile, 1));
  color: #000000;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
  text-overflow: ellipsis;
  margin: 0;
  padding: 0;
  letter-spacing: normal;
}

/* Switch */
.video-switch {
  width: calc(var(--switch-width) * var(--scale-factor-mobile, 1));
  height: calc(var(--switch-height) * var(--scale-factor-mobile, 1));
  display: flex;
  gap: calc(var(--button-gap) * var(--scale-factor-mobile, 1));
  align-items: center;
  justify-content: center;
  padding: 0;
  margin: 0;
}

/* Navigation Button */
.nav-button {
  position: relative;
  width: calc(var(--button-size) * var(--scale-factor-mobile, 1));
  height: calc(var(--button-size) * var(--scale-factor-mobile, 1));
  border: none;
  background: transparent;
  cursor: pointer;
  padding: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: opacity 0.3s ease;
}

/* Navigation Icon */
.nav-icon {
  position: absolute;
  width: 100%;
  height: 100%;
  object-fit: contain;
}

.nav-icon-active {
  opacity: 1;
}

.nav-icon-disable {
  opacity: 0;
}

.nav-button.disabled .nav-icon-active {
  opacity: 0;
}

.nav-button.disabled .nav-icon-disable {
  opacity: 1;
}

.nav-button:not(.disabled):hover {
  opacity: 0.8;
}

/* Player Container */
.video-player-container {
  width: calc(var(--player-width) * var(--scale-factor-mobile, 1));
  height: calc(var(--player-height) * var(--scale-factor-mobile, 1));
  overflow-x: hidden; /* 禁用滚动，仅允许按钮切换 */
  overflow-y: hidden;
  position: relative;
  scrollbar-width: none;
  -ms-overflow-style: none;
  overscroll-behavior: none; /* 确保完全禁用滚动行为 */
}

.video-player-container::-webkit-scrollbar {
  display: none;
}

/* Players Track */
.video-players-track {
  display: flex;
  height: 100%;
}

/* Video Player Item */
.video-player-item {
  position: relative;
  flex-shrink: 0;
  width: calc(var(--player-width) * var(--scale-factor-mobile, 1));
  height: 100%;
  border-radius: var(--border-radius);
  overflow: hidden;
}

/* Video Element */
.video-element {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
}

/* Play Button */
.video-play-button {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: calc(var(--play-button-size) * var(--scale-factor-mobile, 1));
  height: calc(var(--play-button-size) * var(--scale-factor-mobile, 1));
  border: none;
  background: transparent;
  cursor: pointer;
  padding: 0;
  z-index: 3;
  transition: opacity 0.3s ease;
}

.video-play-button:hover {
  opacity: 0.9;
}

.video-play-button img {
  width: 100%;
  height: 100%;
  display: block;
}

/* Gradient Mask */
.video-gradient-mask {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 192px;
  z-index: 1;
  pointer-events: none;
}

.video-gradient-mask img {
  width: 100%;
  height: 100%;
  display: block;
  object-fit: cover;
}

/* Video Info */
.video-info {
  position: absolute;
  bottom: 0;
  left: 0;
  z-index: 1; /* local: under iframe */
  display: flex;
  gap: calc(var(--video-info-gap) * var(--scale-factor-mobile, 1));
  padding: calc(var(--video-info-padding) * var(--scale-factor-mobile, 1));
  pointer-events: none;
}

.creator-avatar {
  flex-shrink: 0;
  width: calc(var(--creator-avatar-size) * var(--scale-factor-mobile, 1));
  height: calc(var(--creator-avatar-size) * var(--scale-factor-mobile, 1));
  border-radius: 50%;
  object-fit: cover;
  pointer-events: auto;
}

.video-metadata {
  display: flex;
  flex-direction: column;
  gap: 5px;
  justify-content: center;
  pointer-events: auto;
}

.creator-name {
  width: calc(var(--creator-name-width) * var(--scale-factor-mobile, 1));
  font-family: 'Kanit', sans-serif;
  font-weight: 700;
  font-size: calc(var(--creator-name-font-size) * var(--scale-factor-mobile, 1));
  line-height: calc(var(--creator-name-line-height) * var(--scale-factor-mobile, 1));
  color: #ffffff;
  margin: 0;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.video-title {
  width: calc(var(--video-title-width) * var(--scale-factor-mobile, 1));
  font-family: 'Kanit', sans-serif;
  font-weight: 500;
  font-size: calc(var(--video-title-font-size) * var(--scale-factor-mobile, 1));
  line-height: calc(var(--video-title-line-height) * var(--scale-factor-mobile, 1));
  color: #ffffff;
  margin: 0;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* Playing State */
.video-player-item.is-playing .video-play-button,
.video-player-item.is-playing .video-gradient-mask,
.video-player-item.is-playing .video-info {
  display: none;
}

/* Tablet: 750px mock applies at full scale */
@media (min-width: 750px) {
  .custom-video.design-scale {
    --scale-factor-mobile: clamp(1, calc(100vw / 750px), 1.2);
  }
}

/* Desktop overrides */
@media (min-width: 990px) {
  .custom-video.design-scale {
    /* Desktop tokens */
    --section-width-desktop: 1920px;
    --section-height-desktop: 1065px;
    
    /* Header */
    --header-width-desktop: 1280px;
    
    /* Title */
    --title-width-desktop: auto;
    
    /* Navigation Buttons */
    --button-size-desktop: 60px;
    --button-gap-desktop: 32px;
    
    /* Player Container */
    --player-container-gap-desktop: 60px;
    
    /* Player Track */
    --player-track-gap-desktop: 40px;
    
    /* Player Item */
    --player-width-desktop: 1280px;
    --player-height-desktop: 720px;
    
    height: calc(var(--section-height-desktop) * var(--scale-factor-desktop, 1));
  }

  /* Video Container - Desktop */
  .video-container {
    width: 100%;
    margin: 0 auto;
    gap: calc(var(--player-container-gap-desktop) * var(--scale-factor-desktop, 1));
  }

  /* Video Header - Desktop */
  .video-header {
    width: calc(var(--header-width-desktop) * var(--scale-factor-desktop, 1));
    height: auto;
    justify-content: space-between;
    align-items: flex-end;
  }

  /* Section Title - Desktop */
  .video-section-title {
    width: var(--title-width-desktop);
    height: auto;
  }

  /* Video Switch - Desktop */
  .video-switch {
    width: auto;
    height: auto;
    gap: calc(var(--button-gap-desktop) * var(--scale-factor-desktop, 1));
  }

  /* Navigation Button - Desktop */
  .nav-button {
    width: calc(var(--button-size-desktop) * var(--scale-factor-desktop, 1));
    height: calc(var(--button-size-desktop) * var(--scale-factor-desktop, 1));
  }

  /* Player Container - Desktop */
  .video-player-container {
    width: 100%;
    height: calc(var(--player-height-desktop) * var(--scale-factor-desktop, 1));
  }

  /* Players Track - Desktop */
  .video-players-track {
    display: flex;
    gap: calc(var(--player-track-gap-desktop) * var(--scale-factor-desktop, 1));
    transform: translateX(calc(-1020px * var(--scale-factor-desktop, 1)));
  }

  /* Video Player Item - Desktop */
  .video-player-item {
    width: calc(var(--player-width-desktop) * var(--scale-factor-desktop, 1));
    height: calc(var(--player-height-desktop) * var(--scale-factor-desktop, 1));
  }

  /* Video Spacer - Desktop */
  .video-spacer {
    background: #F0F0F0;
    flex-shrink: 0;
  }
}

/* Ultra-wide / 4K */
@media (min-width: 1920px) {
  .custom-video.design-scale {
    --scale-factor-desktop: 1;
  }
}

/* ========================================
   Lite YouTube Embed Styles
   ======================================== */

lite-youtube {
  background-color: #000;
  position: relative;
  display: block;
  /* contain: content; */ /* 移除此行，避免层叠上下文问题 */
  background-position: center center;
  background-size: cover;
  cursor: pointer;
  width: 100%;
  height: 100%;
}

/* Gradient overlay for YouTube thumbnails */
lite-youtube::before {
  content: '';
  display: block;
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(
    180deg,
    rgba(0, 0, 0, 0) 0%,
    rgba(0, 0, 0, 0.8) 100%
  );
  pointer-events: none;
  z-index: 1;
}

/* Play button */
lite-youtube > .lty-playbtn {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: calc(var(--play-button-size) * var(--scale-factor-mobile, 1));
  height: calc(var(--play-button-size) * var(--scale-factor-mobile, 1));
  padding: 0;
  border: none;
  background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 68 48'%3E%3Cpath d='M66.52 7.74c-.78-2.93-2.49-5.41-5.42-6.19C55.79.13 34 0 34 0S12.21.13 6.9 1.55c-2.93.78-4.63 3.26-5.42 6.19C.06 13.05 0 24 0 24s.06 10.95 1.48 16.26c.78 2.93 2.49 5.41 5.42 6.19C12.21 47.87 34 48 34 48s21.79-.13 27.1-1.55c2.93-.78 4.64-3.26 5.42-6.19C67.94 34.95 68 24 68 24s-.06-10.95-1.48-16.26z' fill='%23f00'/%3E%3Cpath d='M45 24L27 14v20' fill='%23fff'/%3E%3C/svg%3E") no-repeat center;
  background-size: contain;
  cursor: pointer;
  z-index: 2;
  opacity: 0.9;
  transition: opacity 0.3s ease;
}

lite-youtube:hover > .lty-playbtn,
lite-youtube .lty-playbtn:focus {
  opacity: 1;
}

/* After activation */
lite-youtube.lyt-activated {
  cursor: default;
}

lite-youtube.lyt-activated::before,
lite-youtube.lyt-activated > .lty-playbtn {
  display: none;
}

/* YouTube iframe styles */
lite-youtube > iframe {
  width: 100%;
  height: 100%;
  position: absolute;
  top: 0;
  left: 0;
  border: 0;
  z-index: 2; /* local: above info */
  pointer-events: auto;
}

/* Placeholder when no video configured */
.video-placeholder {
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: #333;
  color: #fff;
  font-family: 'Kanit', sans-serif;
  font-size: calc(20px * var(--scale-factor-mobile, 1));
}

/* ========================================
   修复：移动端 YouTube iframe 交互问题
   ======================================== */

/* 激活后，lite-youtube 元素完全禁用交互 */
lite-youtube.lyt-activated {
  cursor: default !important;
  pointer-events: none !important;
  /* 移除 contain 避免层叠上下文问题 */
  contain: none !important;
}

/* 确保 iframe 在所有情况下都可以接收交互 */
lite-youtube.lyt-activated > iframe {
  width: 100% !important;
  height: 100% !important;
  position: absolute !important;
  top: 0 !important;
  left: 0 !important;
  border: 0 !important;
  z-index: 10 !important; /* 高于 section 内所有元素 */
  pointer-events: auto !important;
  cursor: pointer !important;
  /* 确保在移动端可以接收触摸事件 */
  touch-action: auto !important;
}

/* 播放状态下，video-info 完全隐藏且不可交互 */
.video-player-item.is-playing .video-info,
.video-player-item.is-playing .video-info *,
.video-player-item.is-playing .creator-avatar,
.video-player-item.is-playing .video-metadata {
  display: none !important;
  visibility: hidden !important;
  pointer-events: none !important;
  opacity: 0 !important;
  z-index: -1 !important;
}

/* 移动端额外保护 */
@media (max-width: 749px) {
  lite-youtube.lyt-activated {
    /* 在移动端完全透明化容器 */
    background: transparent !important;
  }
  
  lite-youtube.lyt-activated > iframe {
    /* 移动端确保 iframe 占满并可交互 */
    -webkit-tap-highlight-color: transparent;
  }
}
